#include <module.h>
#include <types.h>
#include <recherche/dichotomique/dichotomique.h>
#include <interfaceUtilisateur/console/console.h>

MODULE(RechercheDichotomique);

void* testGet(void* t, uint32 index) {
	return ((int*)t) + index;
}

int testCmp(void* a, void* b) {
	int aa = *((int*)a);
	int bb = *((int*)b);
	return (aa == bb) ? 0 : ((aa < bb) ? -1 : 1);
}

void initRechercheDichotomique(void** etat) {
	*etat = NULL;
}

void deinitRechercheDichotomique(void** etat) {
	*etat = NULL;
}

int rechercheDichotomiquePremier(void* e, void* t, int taille, AccesseurIndex get, ComparaisonStricte comparer) {
	int i = 0;
	int j = taille - 1;
	int m;
	
	if (comparer(get(t, i), e) == 0)
		return i;
	
	while (i + 1 < j) {
		m = (i + j) / 2;
		if (comparer(get(t, m), e) < 0)
			i = m;
		else
			j = m;
	}
	
	return (comparer(get(t, j), e) == 0) ? j : -1;
}

int rechercheDichotomiqueDernier(void* e, void* t, int taille, AccesseurIndex get, ComparaisonStricte comparer) {
	int i = 0;
	int j = taille - 1;
	int m;
	
	if (comparer(get(t, j), e) == 0)
		return j;
	
	while (i + 1 < j) {
		m = (i + j) / 2;
		if (comparer(get(t, m), e) > 0)
			j = m;
		else
			i = m;
	}
	
	return (comparer(get(t, i), e) == 0) ? i : -1;
}
